function LegalDocumentScreen(){var that=this;var documentObj="";var parentScreen="";var acceptButtonObj=null;var rightScreenHeaderObj=null;var documentContentObj=null;this.setDocument=function(doc){documentObj=doc};this.setParentScreen=function(parent){parentScreen=parent};this.init=function(){_LegalDocumentScreen.init()};this.show=function(){Helper.addClass("legal-document-screen-container","loader");Helper.setHtml("legal-document-header",Helper.cropString(documentObj.name,30,"..."));acceptButtonObj=Helper.byId("legal-document-accept-button");rightScreenHeaderObj=Helper.byId("legal-document-accepted-header");documentContentObj=Helper.byId("legal-document-content");documentContentObj.scrollTop=0;if(documentObj.need_acceptance){Helper.showObject(rightScreenHeaderObj);if(!documentObj.is_accepted){Helper.showObject(acceptButtonObj);Helper.setHtmlForObject(rightScreenHeaderObj,App.lang.get("label-agreement-not-accepted"))}else{Helper.hideObject(acceptButtonObj);Helper.setHtmlForObject(rightScreenHeaderObj,App.lang.get("label-agreement-accepted"))}}else{Helper.hideObject(rightScreenHeaderObj);Helper.hideObject(acceptButtonObj)}App.data.requestLegalDocumentDetail({id:documentObj.id},function(error,doc){Helper.removeClass("legal-document-screen-container","loader");if(error==0){Helper.setHtmlForObject(documentContentObj,doc.html_content)}});_LegalDocumentScreen.show()};this.acceptDocument=function(documentId,callback){App.data.requestLegalDocumentAccept({id:documentId},function(error){var message="Unknown error: "+error;switch(error){case 0:message="agreement-accepted-msg";break;case 1:message="document-not-found-msg";break;case 2:message="document-already-accepted-msg";break}if(callback instanceof Function){callback(error,App.lang.get(message))}})};this.key_back=function(){App.display.showScreen(parentScreen)};this.key_enter=function(){if(!documentObj.is_accepted){App.popupMessageScreen.setMessageText(App.lang.get("offer-accept-message"),App.popupMessageScreen.MODE_CHOICE);App.popupMessageScreen.setCallback(function(flag){if(flag){App.legalDocumentScreen.acceptDocument(documentObj.id,function(error,message){App.popupMessageScreen.setMessageText(message);App.popupMessageScreen.setCallback(function(){App.legalDocumentScreen.key_back()});App.display.showPopupScreen("popup-message")})}});App.display.showPopupScreen("popup-message")}};this.key_down=function(){documentContentObj.scrollTop+=24};this.key_up=function(){documentContentObj.scrollTop-=24};this.key_menu=function(){App.display.showScreen("mainmenu")};this.key_exit=function(){if(App.player.isActive()){App.display.showScreen("player")}else{App.display.showScreen("mainmenu")}};this.key_backspace=function(){this.key_exit()};this.key_power=function(){App.switchStandBy()};this.key_long_enter=function(){if(App.showHelpButtonPanelFlag){var keys=[{action:"back",label:"label-back"}];App.popupKeyPanelScreen.setKeysForPanel(keys);App.popupKeyPanelScreen.setParentScreen("info");App.display.showPopupScreen("popup-key-panel")}else{this.key_enter()}}}_LegalDocumentScreen=new BaseScreen();LegalDocumentScreen.prototype=_LegalDocumentScreen;