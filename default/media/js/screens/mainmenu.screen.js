function MainMenuScreen(){var that=this;var mainMenuConfig={impuls:{displayItemsNumber:10,numberOfColumns:2,numberOfRows:5},impuls_x:{displayItemsNumber:8,numberOfColumns:4,numberOfRows:2}};var mainMenu=new BaseMenu({displayItemsNumber:10,menuId:"mainmenu",menuTag:"div",itemIdPrefix:"mainmenu",relatedItemIdPrefix:"mainmenu-selector",itemTag:"div",useFastRefresh:true,useMovableSelectionEffect:true,getRelatedDisplayItemIndexFunc:function(itemIndex){var ind;if(itemIndex%2===0){ind=itemIndex/2;if(itemIndex===0){ind=0}}else{ind=(itemIndex-1)/2;if(itemIndex===1){ind=0}}return ind},getItemNameFunc:function(sourceItemIndex,displayItemIndex,node){var menuItems=App.mainmenuScreen.getMenuItems();var items=[];for(var i in menuItems){items[items.length]=menuItems[i]}try{var item=items[sourceItemIndex];if(!node){return true}else{var iconElement=document.createElement("span");iconElement.setAttribute("class","icon");iconElement.setAttribute("id","icon-"+item.action);iconElement.setAttribute("style",(item.style?item.style:""));var labelElement=document.createElement("span");labelElement.setAttribute("class","mainmenu-item-label label-mainmenu-"+item.action);labelElement.innerHTML=item.title;node.appendChild(iconElement);node.appendChild(labelElement)}}catch(e){return""}},onItemClick:function(index){that.key_enter()},onItemMouseOver:function(index){mainMenu.resetSelection();mainMenu.setSelectedItem(index,index)}});var selectorMenu=new BaseMenu({displayItemsNumber:5,sourceItemsNumber:5,menuId:"mainmenu-selector",menuTag:"div",itemIdPrefix:"mainmenu-selector",itemTag:"div",useFastRefresh:false});var menuItems=[];var menuActions={};var menuShowed=false;this.getMenuItems=function(){return menuItems};this.show=function(){App.playerScreen.hideTvInfoBar();App.playerScreen.hideVideoInfoBar();_MainMenuScreen.show();if(!menuShowed){mainMenu.setSelectedItem(0,0)}menuShowed=true};this.reset=function(){_MainMenuScreen.setInited(false)};this.init=function(){_MainMenuScreen.init();App.data.requestAccountStatus({},function(error,status,subject,text){if(error==0){var s="";switch(parseInt(status)){default:case 0:if(text){App.popupMessageScreen.setMessageText(Helper.cropString(text,450,"..."));if(App.display.getCurrentScreen()==="tvchannels"){this.hidePreviewPlayer();App.popupMenuScreen.setOnHideCallback(function(){that.showPreviewPlayer()})}App.display.showPopupScreen("popup-message")}break;case 1:s=App.lang.get("account-check-not-found-msg");break;case 2:if(App.clientSettings.account_renewal_message){s=App.clientSettings.account_renewal_message}else{s=App.lang.get("account-check-not-active-msg")}break}if(s){App.data.requestLogout();App.logout();App.popupMessageScreen.setMessageText(s);App.display.showPopupScreen("popup-message")}}},180000)};this.checkMenuItemActionExists=function(action){if(action in menuActions){return true}else{return false}};this.addMenuItem=function(title,action,sortOrder,css){var item={title:title,action:action};if(css){item.style=css}if(action in menuActions){return}menuActions[action]=true;if(sortOrder&&menuItems[sortOrder]){menuItems.splice(sortOrder,0,item);return}if(!sortOrder){sortOrder=menuItems.length}menuItems[sortOrder]=item};this.generateMainMenu=function(){menuShowed=false;var k=0;for(var i in menuItems){k++}var n=k;var style=App.settings.getStyleName();if(n>mainMenuConfig[style]["displayItemsNumber"]){n=mainMenuConfig[style]["displayItemsNumber"]}mainMenu.setNumberOfDisplayItems(n);mainMenu.setNumberOfSourceItems(k);if(n>mainMenuConfig[style]["numberOfColumns"]){}if(n>1){if(n<mainMenuConfig[style]["numberOfColumns"]){mainMenu.setNumberOfColumns(n)}else{mainMenu.setNumberOfColumns(mainMenuConfig[style]["numberOfColumns"])}mainMenu.setNumberOfRows(n/mainMenuConfig[style]["numberOfColumns"])}mainMenu.setSelectedItem(0,0);mainMenu.redrawMenuItems()};this.key_back=function(){var s="app-close-question-msg";if(App.player.isActive()){s="app-close-back-question-msg"}if(App.device.getDeviceKind()==="samsung_smart_tv"||App.device.getDeviceKind()==="tizen_tv"||App.device.getDeviceKind()==="lg_webos"||App.device.getDeviceKind()==="lg_netcast"||App.device.getDeviceKind()==="vewd"){App.loginScreen.askToExit(s,function(value){if(value){App.player.stop();App.device.exitToPortal()}else{App.mainmenuScreen.key_backspace()}})}else{App.mainmenuScreen.key_backspace()}};this.key_down=function(){mainMenu.setDownItem()};this.key_right=function(){mainMenu.setNextItem()};this.key_left=function(){mainMenu.setPreviousItem()};this.key_up=function(){mainMenu.setUpItem()};this.key_enter=function(){var items=[];for(var i in menuItems){items[items.length]=menuItems[i]}var action=items[mainMenu.getSelectedSourceItem()]["action"];switch(action){default:try{App.display.runApplication(action)}catch(e){alert(e)}break;case"categorizedtv":App.display.showScreen("categorizedtv");break;case"tvchannels":App.display.showScreen("tvchannels");break;case"videocatalog":App.display.showScreen("videocatalog");break;case"account":App.display.showScreen("account");break;case"settings":App.display.showScreen("settings");break;case"apps":App.display.showScreen("apps");break;case"exit":App.loginScreen.askToExit("app-close-question-msg",function(value){if(value){App.player.stop();App.device.exitToPortal()}});break}};this.key_exit=function(){var device=App.device.getDeviceKind();if(device==="samsung_smart_tv"||device==="tizen_tv"){App.loginScreen.askToExit("app-close-question-msg",function(value){if(value){App.player.stop();App.device.exitToPortal()}})}else{this.key_backspace()}};this.key_backspace=function(){if(App.player.isActive()){App.display.showScreen("player")}};this.key_power=function(){App.switchStandBy()};this.wheel=function(delta){if(delta>0){this.key_down()}else{this.key_up()}}}var _MainMenuScreen=new BaseScreen();MainMenuScreen.prototype=_MainMenuScreen;